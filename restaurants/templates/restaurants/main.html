{% extends 'base.html' %}
{% load django_bootstrap5 %}
{% load static %}

{% block css %}
  <link rel="stylesheet" href="{% static 'restaurants/css/main.css' %}">
{% endblock css %}

{% block content %}
  <div class="row">
    <p class="title">솔직한 맛 평가</p>
    <h1 class="title">오늘의 플레이트</h1>
    
    <!-- 캐러셀-->
    <div id="carouselExampleIndicators" class="carousel slide p-0" style="overflow: hidden;" data-bs-ride="carousel">
      <div class="slide-container">
        <div class="slide-box"><img src="http://placeimg.com/200/200/nature" draggable="false" class="img-fluid"></div>
        <div class="slide-box"><img src="http://placeimg.com/200/200/natures" draggable="false" class="img-fluid"></div>
        <div class="slide-box"><img src="http://placeimg.com/200/200/future" draggable="false" class="img-fluid"></div>
      </div>
      <div class="carousel-indicators">
        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="slide-1 active" aria-current="true" aria-label="Slide 1"></button>
        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1" class="slide-2" aria-label="Slide 2"></button>
        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2" class="slide-3" aria-label="Slide 3"></button>
      </div>
    </div>

    <!-- 인기 검색어 -->
  <div class="row">
    <div class="col">인기검색어</div>
    {% for w in s %}
    <div class="col">
      <span>#</span>
      <label for="search" class="css-xd55zv e1387oiq0" id="{{w.pk}}">{{ w.keyword }}</label>
    </div>
    {% endfor %}
  </div>

    <!--검색-->
    <form class="d-flex" action="{% url 'restaurants:search' %}">
      <input class="form-control me-2" type="search" placeholder="Search" name="search" aria-label="Search" id="search">
      <button class="btn btn-outline-warning" type="submit">
        Search
      </button>
    </form>
  
  <!-- 카테고리 -->
  <h3>카테고리</h3>
  <div class="food_cate">
    <a href="{% url 'restaurants:menu' %}">
      <div class="a_menu">
        <img src="https://cdn-icons-png.flaticon.com/512/4480/4480784.png" alt="한식 카테고리">
        <p>한식</p>
      </div>
    </a>
    <a href="{% url 'restaurants:menu' %}">
      <div class="a_menu">
        <img src="https://cdn-icons-png.flaticon.com/512/3511/3511307.png" alt="양식 카테고리">
        <p>양식</p>
      </div>
    </a>
    <a href="{% url 'restaurants:menu' %}">
      <div class="a_menu">
        <img src="https://cdn-icons-png.flaticon.com/512/2548/2548242.png" alt="중식 카테고리">
        <p>중식</p>
      </div>
      <a href="{% url 'restaurants:menu' %}">
        <div class="a_menu">
          <img src="https://cdn-icons-png.flaticon.com/512/5391/5391971.png" alt="일식 카테고리">
          <p>일식</p>
        </div>
      </a>
    </a>
    <a href="{% url 'restaurants:menu' %}">
      <div class="a_menu">
        <img src="https://cdn-icons-png.flaticon.com/512/7688/7688778.png" alt="기타 카테고리">
        <p>기타</p>
      </div>
    </a>
  </div>

  <!--음식 그림-->
  <div class="row">
    <h3 class="title">끌리는 음식</h3>
    <!-- 지역선택 -->
    <div class="row row-cols-4" id="random-food">
    </div>
  </div>

  <!--더 보기 -->
  <button id="shuffle-menu" class="btn btn-primary" type="button">다른 메뉴 보기</button>
  {% comment %} <script src="{% static 'restaurants/js/main.js' %}"></script>  {% endcomment %}


  <!-- 랜덤 음식 -->
  <script>
    const row = document.querySelector("#random-food");
    var foodsList = ["떡볶이.jpg", "삼겹살.jpg", "치킨.png", "피자.jpg", "김밥.jpg", '비빔밥.jpg', '죽.jpg', '칼국수.jpg', '물냉면.jpg', '짜장면.jpg', '짬뽕.jpg', '떡갈비.jpg', '갈비찜.jpg', '해물찜.jpg', '계란말이.jpg', '순대국.jpg', '감자탕.jpg',];
    temp(0);

    function temp(num) {
        var template = [];
        for (let i = 0; i < 4; i++) {
            var a = foodsList[(i + num) % foodsList.length];
            var url = "{% static 'restaurants/img/change' %}".replace("change", a);
            template.push(`<div class="col text-center"><img src="${url}" alt="" class="img-fluid rounded-pill"></div>`);
            row.insertAdjacentHTML("beforeend", template[i]);
        }
    }

    const shuffleMenu = document.querySelector("#shuffle-menu");
    shuffleMenu.addEventListener("click", () => {
        row.innerHTML = "";
        temp(Math.floor(Math.random() * (foodsList.length-1 - 0) + 1));
    });
  </script>

  <!-- 캐러셀 -->
  <script>
    document.querySelector('.slide-2').addEventListener('click',()=>{
      document.querySelector('.slide-container').style.transform = 'translateX(-100vw)'
      document.querySelector('.slide-2').classList.add('active')
      document.querySelector('.slide-1').classList.remove('active')
      document.querySelector('.slide-3').classList.remove('active')
  })
  document.querySelector('.slide-3').addEventListener('click',()=>{
      document.querySelector('.slide-container').style.transform = 'translateX(-200vw)'
      document.querySelector('.slide-3').classList.add('active')
      document.querySelector('.slide-1').classList.remove('active')
      document.querySelector('.slide-2').classList.remove('active')
  })
  document.querySelector('.slide-1').addEventListener('click',()=>{
      document.querySelector('.slide-container').style.transform = 'translateX(0vw)'
      document.querySelector('.slide-1').classList.add('active')
      document.querySelector('.slide-2').classList.remove('active')
      document.querySelector('.slide-3').classList.remove('active')
  })
  </script>
  
{% endblock content %}







<!-- 캐러셀 실패작 -->
{% comment %} <script>
    var start = 0
    var clicking = false
    var slideBox = document.querySelectorAll('.slide-box')

    SlideBox(0)
    SlideBox(1)
    SlideBox(2)

    function SlideBox(num) {
        SlideBoxMouseDown(num)
        SlideBoxMouseMove(num)
        SlideBoxMouseUp(num)
      }
    
    function SlideBoxMouseDown(num) {
      slideBox[num].addEventListener('mousedown',(e)=>{
        start = e.screenX
        clicking = true
      })
    }
    function SlideBoxMouseMove(num){
      slideBox[num].addEventListener('mousemove',(e)=>{
          if (clicking == true) {
              document.querySelector('.slide-container').style.transform = `translateX(${(-1)*(num*100)+e.screenX - start}px)`
          }
      })
    }
    function SlideBoxMouseUp(num) {
      slideBox[num].addEventListener('mouseup',(e)=>{
          clicking = false
          if (e.clientX - start < -100){
              document.querySelector('.slide-container').style.transform = `translateX(-${((num+1)*100)%300}vw)`
              document.querySelector('.slide-container').style.transition = 'all 0.5s'
          } else {
              document.querySelector('.slide-container').style.transform = `translateX(-${(num*100)%300}vw)`
              document.querySelector('.slide-container').style.transition = 'all 0.5s'
          }
          setTimeout(()=>{
              document.querySelector('.slide-container').style.transition = 'none'
          }, 500)
      })  
    }
    
  </scrip> {% endcomment %}